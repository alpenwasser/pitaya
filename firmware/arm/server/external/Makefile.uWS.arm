CPP_SHARED := -std=c++11 -O3 -I src -shared -fPIC src/Extensions.cpp src/Group.cpp src/Networking.cpp src/Hub.cpp src/Node.cpp src/WebSocket.cpp src/HTTPSocket.cpp src/Socket.cpp src/Epoll.cpp
CPP_OPENSSL_ARM = -I../build/openssl/include -L../build/openssl/lib
CPP_ZLIB_ARM = -I../build/zlib/include -L../build/zlib/lib
CPP_ARM = $(CPP_OPENSSL_ARM) $(CPP_ZLIB_ARM)
CXX_ARM = arm-linux-gnueabihf-g++
BUILD = ../build

all:
	$(CXX_ARM) $(CPPFLAGS) $(CFLAGS) $(CPP_SHARED) $(CPP_ARM) -s -o libuWS.so

.PHONY: install
install:
	make -f ../Makefile.uWS.arm installARM

.PHONY: installARM
installARM:
	mkdir -p $(BUILD)/uWS/lib
	mkdir -p $(BUILD)/uWS/include
	cp libuWS.so $(BUILD)/uWS/lib
	cp src/*.h $(BUILD)/uWS/include

.PHONY: clean
clean:
	rm -f libuWS.so
	rm -f libuWS.dylib
